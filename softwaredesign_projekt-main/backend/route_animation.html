<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>Routenanimation</title>
  <link rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""/>
  <style>
    html, body, #map {
      height: 100%;
      width: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
          crossorigin=""></script>
  <script>
    // Koordinaten der Route aus Python
    var routeCoords = [[48.994816, 8.4017625], [48.9952851, 8.4043272], [48.9953543, 8.4044967], [48.9956873, 8.4044764], [48.9958477, 8.4055455], [48.9958408, 8.4069428], [48.9959957, 8.4084627], [48.9960553, 8.4093192], [48.9960305, 8.4098365], [48.9963882, 8.411388], [48.9964736, 8.4113314], [48.9966211, 8.4112339], [48.9970429, 8.4109904], [48.9976454, 8.4130486], [48.9986657, 8.4157244], [49.0000518, 8.4198697], [49.0001626, 8.4202319], [49.0006886, 8.4219671], [49.0012416, 8.4230355], [49.0020246, 8.4237083], [49.0025021, 8.4239269], [49.0029791, 8.4242986], [49.0006676, 8.4264686], [49.0006748, 8.4266712], [49.0023351, 8.4315949], [49.0034713, 8.4342371], [49.0050959, 8.4374477], [49.0040985, 8.4423653], [49.0032502, 8.4474766], [49.0030577, 8.4486343], [49.0025349, 8.4517391], [49.0022386, 8.4533109], [49.0019556, 8.4549768], [49.0013747, 8.4569463], [49.0013523, 8.4574026], [49.0023104, 8.4614713], [49.0025954, 8.4621544]];

    if (!routeCoords || routeCoords.length === 0) {
      alert("Keine Routenkoordinaten vorhanden.");
    } else {
      // Karte initialisieren
      var map = L.map('map').setView(routeCoords[0], 13);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap-Mitwirkende'
      }).addTo(map);

      // Graue Hintergrundroute
      L.polyline(routeCoords, {
        color: 'gray',
        weight: 3,
        opacity: 0.5
      }).addTo(map);

      // Rote Linie, die nach und nach wächst
      var filledLine = L.polyline([], {
        color: 'red',
        weight: 5,
        opacity: 0.9
      }).addTo(map);

      // Fahrender Marker
      var vehicle = L.circleMarker(routeCoords[0], {
        radius: 6,
        color: 'red',
        fillColor: 'red',
        fillOpacity: 1.0
      }).addTo(map);

      var i = 0;
      var maxIndex = routeCoords.length;

      function step() {
        if (i >= maxIndex) {
          return; // Animation fertig
        }

        var coord = routeCoords[i];
        filledLine.addLatLng(coord);
        vehicle.setLatLng(coord);

        i += 1;

        // Geschwindigkeit der Animation (ms) – kleiner = schneller
        setTimeout(step, 150);
      }

      step(); // Animation starten
    }
  </script>
</body>
</html>
